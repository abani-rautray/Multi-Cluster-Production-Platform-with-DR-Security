FINAL EXECUTION ORDER (VERY IMPORTANT)
ğŸ”¹ PHASE 1 â€” Terraform (Infrastructure)
1ï¸âƒ£ Create Primary cluster
cd infra/eks-primary
terraform init
terraform validate
terraform plan
terraform apply


âœ… Verify:

aws eks list-clusters
aws eks update-kubeconfig --name prod-primary --region ap-south-1
kubectl get nodes


You must see:

EKS cluster

Managed node group nodes

2ï¸âƒ£ Create DR cluster
cd ../eks-dr
terraform init
terraform validate
terraform plan
terraform apply


âœ… Verify:

aws eks update-kubeconfig --name prod-dr --region ap-south-1
kubectl get nodes

ğŸ”¹ PHASE 2 â€” ArgoCD Bootstrap (ONE TIME ONLY)
3ï¸âƒ£ Switch to Primary cluster
kubectl config use-context prod-primary

4ï¸âƒ£ Install ArgoCD
kubectl apply -k gitops/argocd/


Your gitops/argocd/ is correct because you have:

namespace.yaml

kustomization.yaml

âœ… Verify:

kubectl get pods -n argocd


All pods must be Running.

ğŸ”¹ PHASE 3 â€” GitOps Control Plane
5ï¸âƒ£ Apply App-of-Apps
kubectl apply -f gitops/argocd/app-of-apps.yaml


âœ… Verify:

kubectl get applications -n argocd


You should see:

platform-apps

sample-app

Status should move to Synced / Healthy

ğŸ”¹ PHASE 4 â€” Cluster Manifests (Apps + Karpenter)
6ï¸âƒ£ Primary cluster apps

ArgoCD will automatically apply:

clusters/prod-primary/
â”œâ”€â”€ namespaces.yaml
â”œâ”€â”€ apps.yaml
â””â”€â”€ karpenter/


âœ… Verify:

kubectl get pods -n app-prod
kubectl get nodepool
kubectl get ec2nodeclass

7ï¸âƒ£ Karpenter validation

Deploy workload â†’ nodes should scale.

kubectl scale deployment nginx -n app-prod --replicas=5
kubectl get nodes


You should see new nodes created by Karpenter.

ğŸ”¹ PHASE 5 â€” Observability
8ï¸âƒ£ Apply observability via GitOps

Ensure these are referenced in ArgoCD apps:

observability/prometheus
observability/grafana
observability/alerts


âœ… Verify:

kubectl get pods -n observability


Grafana test:

kubectl port-forward svc/grafana 3000:80 -n observability

ğŸ”¹ PHASE 6 â€” Disaster Recovery (Velero)
9ï¸âƒ£ Install Velero (Primary)
kubectl apply -f dr/velero/install.yaml

ğŸ”Ÿ Take backup
kubectl apply -f dr/velero/backup.yaml
kubectl get backup -n velero

1ï¸âƒ£1ï¸âƒ£ Restore in DR cluster
kubectl config use-context prod-dr
kubectl apply -f dr/velero/install.yaml
kubectl apply -f dr/velero/restore.yaml


âœ… Verify:

kubectl get pods -n app-prod

ğŸŸ¢ FINAL VALIDATION CHECKLIST (Tick These)

âœ… Two EKS clusters
âœ… Separate Terraform states
âœ… ArgoCD running
âœ… GitOps syncing
âœ… Karpenter creating nodes
âœ… Prometheus & Grafana running
âœ… Velero backup & restore works

If all are âœ… â€” YOU ARE DONE